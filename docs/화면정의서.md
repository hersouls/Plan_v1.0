📋 Moonwave Plan 화면정의서 v1.0 (Plan_v2.0 동기화)

## 📋 목차
1. [프로젝트 개요](#📖-프로젝트-개요)
2. [데이터 구조](#📊-데이터-구조)
3. [화면 구조도](#🏗️-화면-구조도)
4. [화면별 상세 정의](#🎯-화면별-상세-정의)
   - 4.1. [메인 화면 (Home)](#1-메인-화면-home)
   - 4.2. [할일 생성 화면 (TaskCreate)](#2-할일-생성-화면-taskcreate)
   - 4.3. [할일 상세 화면 (TaskDetail)](#3-할일-상세-화면-taskdetail)
   - 4.4. [가족 관리 화면 (FamilyManage)](#4-가족-관리-화면-familymanage)
   - 4.5. [통계 화면 (Statistics)](#5-통계-화면-statistics)
   - 4.6. [설정 화면 (Settings)](#6-설정-화면-settings)
   - 4.7. [로그인 화면 (Login)](#7-로그인-화면-login)
   - 4.8. [알림 화면 (Notifications)](#8-알림-화면-notifications)
   - 4.9. [포인트 관리 화면 (PointsManagement)](#9-포인트-관리-화면-pointsmanagement)
   - 4.10. [소개 페이지 (AboutUs)](#10-소개-페이지-aboutus)
   - 4.11. [이용약관 (TermsOfService)](#11-이용약관-termsofservice)
   - 4.12. [프로젝트 상세 (ProjectDetail)](#12-프로젝트-상세-projectdetail)
   - 4.13. [404 페이지 (NotFound)](#13-404-페이지-notfound)
5. [공통 컴포넌트](#🧩-공통-컴포넌트)
6. [상태 관리](#🔄-상태-관리)
7. [반응형 디자인](#📱-반응형-디자인)
8. [성능 최적화](#⚡-성능-최적화)
9. [접근성](#♿-접근성)
10. [PWA 설정](#📱-pwa-설정)
11. [버전 정보](#📌-버전-정보)

---

## 📖 프로젝트 개요

### 프로젝트 정보
- **프로젝트명**: Moonwave Plan (To-Do List)
- **도메인**: https://plan.moonwave.kr
- **기술 스택**: React 18 + Vite + Tailwind CSS + Radix UI + Firebase
- **배포**: Vercel
- **서비스 타입**: 정적 SPA + PWA

### 핵심 컨셉
> "가족과 함께하는 스마트한 할일 관리" - 가족 구성원 모두가 함께 참여하고 소통하는 협업형 할일 관리 서비스

### 주요 기능
- ✅ 할일 관리 (생성/수정/삭제/완료)
- 👨‍👩‍👧‍👦 가족 그룹 관리 및 할일 공유
- 🔔 실시간 알림 및 리마인더
- 📊 완료율 통계 및 게임화 요소
- 🎯 카테고리별/담당자별 필터링
- 🔄 반복 할일 자동 생성
- 💬 댓글 및 이모지 반응

---

## 📊 데이터 구조

### Firestore 컬렉션 구조
```
groups/
  └── {groupId}/
      ├── info (그룹 기본 정보)
      └── members/ (구성원 서브컬렉션)
          └── {memberId}

tasks/
  └── {taskId}/
      ├── info (할일 정보)
      └── comments/ (댓글 서브컬렉션)
          └── {commentId}

users/
  └── {userId}/
      ├── profile
      └── settings
```

### 핵심 데이터 모델 (Plan_v2.0 반영)
```typescript
export type TaskStatus = 'pending' | 'in_progress' | 'completed';
export type TaskPriority = 'low' | 'medium' | 'high';
export type TaskCategory = string;

export interface FileAttachment {
  id: string;
  fileName: string;
  fileSize: number;
  mimeType: string;
  storageUrl: string;
  downloadUrl?: string;
  uploadedBy: string;
  uploadedAt: Timestamp;
  thumbnailUrl?: string;
  isImage: boolean;
  width?: number;
  height?: number;
}

export interface UrlAttachment {
  id: string;
  url: string;
  title?: string;
  description?: string;
  thumbnailUrl?: string;
  domain?: string;
  addedBy: string;
  addedAt: Timestamp;
}

export interface Reminder {
  id: string;
  time: string;              // ISO or relative ("30m", "1h")
  method: 'push' | 'email' | 'both';
  sent?: boolean;
}

export interface RecurringConfig {
  enabled: boolean;
  frequency: 'daily' | 'weekly' | 'monthly' | 'yearly';
  interval: number;
  endDate?: string;
  daysOfWeek?: number[];     // weekly: 0=Sun
  dayOfMonth?: number;       // monthly: 1-31
}

export interface Task {
  id: string;
  taskType: 'personal' | 'group';
  groupId?: string;
  userId: string;
  assigneeId: string;
  assigneeName?: string;
  title: string;
  description?: string;
  status: TaskStatus;
  priority: TaskPriority;
  category: TaskCategory;
  dueDate?: Timestamp;
  estimatedMinutes?: number;
  actualMinutes?: number;
  recurring?: RecurringConfig;
  tags: string[];
  attachments?: FileAttachment[];
  urls?: UrlAttachment[];
  location?: { lat: number; lng: number; address?: string };
  completedAt?: Timestamp;
  completedBy?: string;
  completionNotes?: string;
  watchers: string[];
  mentionedUsers: string[];
  reminders: Reminder[];
  commentCount?: number;
  isStarred?: boolean;
  version: number;
  archivedAt?: Timestamp;
  createdAt: Timestamp;
  updatedAt: Timestamp;
}

export interface Group {
  id: string;
  name: string;
  description?: string;
  avatar?: string;
  ownerId: string;
  memberIds: string[];
  memberRoles: Record<string, 'owner' | 'admin' | 'vice_owner' | 'member' | 'viewer'>;
  settings: {
    allowMembersToInvite: boolean;
    requireApprovalForNewMembers: boolean;
    defaultRole: 'owner' | 'admin' | 'vice_owner' | 'member' | 'viewer';
    taskCategories: string[];
    taskTags: string[];
  };
  statistics: {
    totalTasks: number;
    completedTasks: number;
    activeTasks: number;
    lastActivityAt: Timestamp;
    activeMembersCount: number;
  };
  isPublic: boolean;
  tags: string[];
  createdAt: Timestamp;
  updatedAt: Timestamp;
}

export interface User {
  id: string;
  email: string;
  displayName: string;
  photoURL?: string;
  status: 'online' | 'offline' | 'away' | 'busy';
  groupIds: string[];
  preferences: { theme: 'light' | 'dark' | 'system'; language: string };
  stats: { totalTasksCompleted: number; completionRate: number };
  createdAt: Timestamp;
  updatedAt: Timestamp;
}
```

---

## 🏗️ 화면 구조도

### 화면 플로우 다이어그램
```mermaid
flowchart TB
    Home[메인 대시보드<br/>(오늘의 할일)]:::main
    TaskCreate[할일 생성]:::create
    TaskDetail[할일 상세/수정]:::detail
    FamilyManage[가족 관리]:::family
    Statistics[통계/리포트]:::stats
    Settings[설정]:::settings

    %% 연결선
    Home -->|할일 추가| TaskCreate
    Home -->|할일 클릭| TaskDetail
    Home -->|가족 관리| FamilyManage
    Home -->|통계 보기| Statistics
    Home -->|설정| Settings
    TaskDetail -->|수정| TaskCreate
    FamilyManage -->|멤버 초대| Settings

    %% 스타일
    classDef main fill:#C7DFF4,stroke:#03428E,color:#000,font-weight:bold;
    classDef create fill:#E5F9F9,stroke:#119891,color:#000;
    classDef detail fill:#DCFFFF,stroke:#2EC9D6,color:#000;
    classDef family fill:#FDF5E6,stroke:#F59E0B,color:#000;
    classDef stats fill:#FFF5F5,stroke:#EF4444,color:#000;
    classDef settings fill:#F0FFF0,stroke:#10B981,color:#000;
```

### 네비게이션 구조
```
┌─────────────────────────────────────────┐
│           메인 대시보드 (/)              │
│     (/todo alias, 오늘의 할일)           │
└───────────────┬───────────────┬──────────┘
        ▼                   ▼               ▼
┌────────────┐     ┌────────────┐    ┌────────────┐
│ 할일 생성  │     │ 할일 상세  │    │ 가족 관리  │
│/tasks/create│     │/tasks/{id} │    │/family     │
└────────────┘     └──────┬─────┘    └────────────┘
                            │
                            ▼
                     ┌────────────┐
                     │ 할일 편집  │
                     │/tasks/{id}/│
                     │   edit     │
                     └────────────┘

추가 액세스:  /statistics, /settings, /notifications, /points
공개 페이지:  /login, /about, /terms-of-service, /project-detail/{projectId}
404 처리:     모든 기타 경로 → 404
```

---

## 🎯 화면별 상세 정의

### 1. 메인 화면 (Home)

#### 화면 ID: HOME-001
#### 화면명: 메인 대시보드
#### URL: `/` (별칭: `/todo`)
#### 목적: 오늘의 할일 확인, 진행 현황 파악, 빠른 할일 추가

#### 레이아웃 (요약)
```
┌─────────────────────────────────────────┐
│  Hero Section (브랜드/오늘의 요약/진행률) │
│  Quick Add (빠른 추가 입력/버튼)           │
│  필터 (오늘/이번주/전체, 개인/그룹/전체)   │
│  오늘의 할일 리스트 (TaskCard, 체크/상세)  │
│  가족 활동 요약                           │
│  Floating Action Button [+]               │
└─────────────────────────────────────────┘
```

#### 주요 동작
- 빠른 추가로 `createTask` 호출 (개인/그룹 컨텍스트 기반)
- 체크로 완료 토글, 카드 클릭 시 상세 이동(`/tasks/{id}`)
- 필터: 시간(viewFilter) + 가시성(taskVisibility)

---

### 2. 할일 생성 화면 (TaskCreate)

#### 화면 ID: CREATE-001
#### 화면명: 새 할일 만들기
#### URL: `/tasks/create` 또는 `/tasks/{id}/edit`
#### 목적: 새 할일 생성 또는 기존 할일 수정

#### 입력 필드 & 규칙
- 제목(필수), 설명(선택), 개인/그룹, 그룹/담당자 선택, 우선순위, 카테고리, 마감일/시간
- 반복(주기/요일/종료일), 알림(다중), 태그, 예상 시간, 위치, 첨부파일/URL

#### 기타
- 그룹이 없을 때 그룹 선택 시 개인으로 자동 전환
- 편집 모드에서 기존 Task 데이터 폼에 맵핑

---

### 3. 할일 상세 화면 (TaskDetail)

#### 화면 ID: DETAIL-001
#### 화면명: 할일 상세 정보
#### URL: `/tasks/{id}`
#### 목적: 상세 확인, 상태 변경, 댓글/활동, 첨부파일 확인

#### 주요 섹션
- 헤더(제목/우선순위/카테고리/마감/담당자, 상태 변경/삭제/편집)
- 활동 로그, 댓글(작성/삭제/반응), 첨부/URL, 반복/리마인더 표시

---

### 4. 가족 관리 화면 (FamilyManage)

#### 화면 ID: FAMILY-001
#### 화면명: 가족 그룹 관리
#### URL: `/family`
#### 목적: 그룹 생성/편집/삭제, 초대/가입, 멤버 권한/통계

#### 주요 기능
- 그룹 선택(즐겨찾기 정렬), 초대 코드/QR, 이메일 초대/역할 변경/제거
- 멤버별 통계(생성/할당/완료/포인트), 활동/온라인 상태, 채팅(전체화면 모달)

---

### 5. 통계 화면 (Statistics)

#### 화면 ID: STATS-001
#### 화면명: 통계 및 리포트
#### URL: `/statistics`
#### 목적: 기간/그룹 기준 통계(완료율/카테고리/랭킹)

#### 주요 기능
- 기간 선택(7/30/3개월/연간), 그룹 선택(즐겨찾기 우선)
- 개요/차트/리더보드/카테고리 분포/멤버별 포인트 합산

---

### 6. 설정 화면 (Settings)

#### 화면 ID: SETTINGS-001
#### 화면명: 설정
#### URL: `/settings`
#### 목적: 프로필, 알림, 개인정보, 데이터 관리

#### 탭 구성
- 프로필(Profile), 알림(Notification), 개인정보(Privacy), 데이터(Data)
- 저장 버튼(상단 고정), 로딩/에러 상태 처리

---

### 7. 로그인 화면 (Login)

#### 화면 ID: LOGIN-001
#### 화면명: 로그인/회원가입
#### URL: `/login`
#### 목적: 이메일/비밀번호 로그인, 회원가입, 비밀번호 재설정, Google/익명 로그인

#### 레이아웃
```
┌─────────────────────────────────────────┐
│  [로그인] [회원가입] 탭 토글             │
│  이메일/비밀번호 (표시 토글)             │
│  (회원가입) 이름/비밀번호 확인           │
│  [로그인/가입], [Google로 계속], [익명 시작] │
│  [비밀번호 재설정]                       │
└─────────────────────────────────────────┘
```

---

### 8. 알림 화면 (Notifications)

#### 화면 ID: NOTI-001
#### 화면명: 알림 센터
#### URL: `/notifications`
#### 목적: 알림 확인/필터/읽음/삭제

#### 주요 기능
- 필터(전체/읽지않음/읽음, 타입: task/group/system/reminder)
- 단건/전체 읽음 처리, 삭제, 상대/절대 시간 표기

---

### 9. 포인트 관리 화면 (PointsManagement)

#### 화면 ID: POINTS-001
#### 화면명: 포인트 관리
#### URL: `/points`
#### 목적: 그룹/멤버별 포인트 내역 관리, 승인, 분석/설정

#### 구성
- 그룹/멤버 선택(즐겨찾기/로그인 사용자 우선)
- 미승인/승인 내역, 요약 카드, 랭킹
- 모달: 포인트 추가/차감, 설정, 설명, 작업 상세, AI 분석

---

### 10. 소개 페이지 (AboutUs)

#### 화면 ID: ABOUT-001
#### 화면명: 서비스 소개
#### URL: `/about`
#### 목적: Moonwave 브랜드/프로젝트 소개 및 외부 링크

#### 섹션
- Hero/브랜드, 프로젝트 카드(여러 moonwave 서브도메인), 가치, 기술 스택

---

### 11. 이용약관 (TermsOfService)

#### 화면 ID: TERMS-001
#### 화면명: 서비스 이용약관
#### URL: `/terms-of-service`
#### 목적: 약관 및 개인정보 처리방침 안내

#### 섹션
- Hero, 약관 조항(시행일/변경/정의/제공/이용 등), 문의/보안 아이콘

---

### 12. 프로젝트 상세 (ProjectDetail)

#### 화면 ID: PROJ-001
#### 화면명: 프로젝트 상세
#### URL: `/project-detail/{projectId}`
#### 목적: About에서 선택한 프로젝트 상세 정보 제공

#### 특징
- 동적 라우트, 존재하지 않을 시 안내와 /about 이동 버튼

---

### 13. 404 페이지 (NotFound)

#### 화면 ID: NOTFOUND-001
#### 화면명: 404 - 페이지 없음
#### URL: `*`
#### 목적: 잘못된 경로 안내 및 대체 이동 경로 제공

#### 구성
- 404 강조, 홈/이전 버튼, 도움 링크(/about, /settings, 이용약관)

---

## 🧩 공통 컴포넌트

### 1. GlassCard (Moonwave Style)
```typescript
interface GlassCardProps {
  variant?: 'default' | 'strong' | 'light' | 'medium';
  withWaveEffect?: boolean;
  hoverable?: boolean;
  className?: string;
  children: React.ReactNode;
}
```

### 2. TaskCard (요약)
```tsx
<Card className="hover:shadow-lg transition-shadow p-4">
  <div className="flex items-start gap-3">
    <Checkbox checked={task.status === 'completed'} />
    <div className="flex-1">
      <h3 className="font-semibold">{task.title}</h3>
      {task.description && (
        <p className="text-sm text-muted-foreground">{task.description}</p>
      )}
      <div className="mt-2 flex items-center gap-4 text-sm">
        <Badge>{task.category}</Badge>
        <span>{task.assigneeName}</span>
        {task.dueDate && <span>{formatDate(task.dueDate)}</span>}
      </div>
    </div>
  </div>
</Card>
```

### 3. QuickAddTask (요약)
```tsx
<div className="relative">
  <Input
    placeholder="할일을 빠르게 추가하세요..."
    value={quickTaskTitle}
    onChange={(e) => setQuickTaskTitle(e.target.value)}
    onKeyPress={(e) => e.key === 'Enter' && handleQuickAdd()}
    className="pr-20"
  />
  <div className="absolute right-2 top-1/2 -translate-y-1/2 flex gap-2">
    <Button size="sm" variant="ghost" onClick={handleQuickAdd}>
      추가
    </Button>
  </div>
</div>
```

---

## 🔄 상태 관리

### 전역 상태 (Firebase + Context)
```typescript
interface AppState {
  user: User | null;
  familyGroup: Group | null;
  tasks: Task[];
  notifications: Notification[];
  isLoading: boolean;
  error: string | null;
}
```

### Firebase 실시간 구독 패턴 (예)
```typescript
useEffect(() => {
  if (!user || !groupId) return;
  const tasksRef = collection(db, 'tasks');
  const q = query(tasksRef, where('groupId', '==', groupId), orderBy('createdAt', 'desc'));
  const unsubscribe = onSnapshot(q, (snapshot) => {
    const tasks = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() })) as Task[];
    setTasks(tasks);
  });
  return unsubscribe;
}, [user, groupId]);
```

---

## 📱 반응형 디자인

### 브레이크포인트
| 디바이스 | 너비 | 레이아웃 변경 |
|----------|------|---------------|
| 모바일 | ~640px | 단일 컬럼, 하단 네비게이션 |
| 태블릿 | 640px~ | 2컬럼 그리드, 사이드바 |
| 데스크톱 | 1024px~ | 3컬럼 그리드, 확장 뷰 |

### 모바일 최적화
- 스와이프 제스처로 할일 완료
- 하단 시트 UI 패턴
- 터치 타겟 최소 44px
- 고정 하단 네비게이션

---

## ⚡ 성능 최적화

### 라우트별 코드 스플리팅 예시
```tsx
const TodoHome = lazy(() => import('./pages/TodoHome'));
const TaskCreate = lazy(() => import('./pages/TaskCreate'));
const TaskDetailPage = lazy(() => import('./pages/TaskDetailPage'));
const FamilyManage = lazy(() => import('./pages/FamilyManage'));
const PointsManagement = lazy(() => import('./pages/PointsManagement'));
const Statistics = lazy(() => import('./pages/Statistics'));
const Settings = lazy(() => import('./pages/Settings'));
const Notifications = lazy(() => import('./pages/Notifications'));
const Login = lazy(() => import('./pages/Login'));
```

---

## ♿ 접근성

### ARIA 속성
- 모든 인터랙티브 요소에 aria-label
- 동적 콘텐츠에 aria-live
- 포커스 관리 및 키보드 네비게이션

### 큰 글씨 모드
- 고령자를 위한 폰트 크기 조절
- 고대비 모드 지원

---

## 📱 PWA 설정

### manifest.json (예)
```json
{
  "name": "Moonwave Plan",
  "short_name": "Plan",
  "description": "가족과 함께하는 할일 관리",
  "start_url": "/",
  "display": "standalone",
  "theme_color": "#9333ea",
  "background_color": "#ffffff",
  "icons": [
    { "src": "/icon-192.png", "sizes": "192x192", "type": "image/png" },
    { "src": "/icon-512.png", "sizes": "512x512", "type": "image/png" }
  ]
}
```

### Service Worker
- 오프라인 캐싱
- 백그라운드 동기화
- 푸시 알림 (FCM)

---

## 📌 버전 정보
- **문서 버전**: v1.0
- **동기화 대상**: Plan_v2.0 (현재 라우트/화면 100% 반영)
- **주요 변경**:
  - 라우트 정정: `/tasks/create`, `/tasks/:taskId/edit`, `/todo` alias
  - 신규 화면 반영: 로그인, 알림, 포인트, 소개, 이용약관, 프로젝트 상세, 404
  - 데이터 모델 확장: 첨부파일/URL/반복/리마인더/감시자/아카이브 등
  - 네비게이션 구조/코드 스플리팅 섹션 최신화